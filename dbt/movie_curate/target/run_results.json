{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.4", "generated_at": "2024-08-08T13:48:43.404983Z", "invocation_id": "18ffedab-ee2f-47d3-9fe6-c94b73a46c21", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-08T13:48:27.532442Z", "completed_at": "2024-08-08T13:48:27.541972Z"}, {"name": "execute", "started_at": "2024-08-08T13:48:27.541972Z", "completed_at": "2024-08-08T13:48:34.440631Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.910251140594482, "adapter_response": {"_message": "CREATE TABLE (45.4k rows, 33.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 45388, "bytes_processed": 34833046, "bytes_billed": 35651584, "location": "US", "project_id": "ee-india-se-data", "job_id": "ce64c075-da80-4a90-983c-51f6c1b9d74c", "slot_ms": 11659}, "message": "CREATE TABLE (45.4k rows, 33.2 MiB processed)", "failures": null, "unique_id": "model.movie_curate.movies_raw_to_curate", "compiled": true, "compiled_code": "/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing \"table\" to \"view\" below\n*/\n\n\n\nWITH movie_source as (SELECT *\n                      from ee-india-se-data.movies_data_punit.movies_raw)\nSELECT SAFE_CAST(adult AS boolean)                          as adult,\n       PARSE_JSON(JSON_EXTRACT(belongs_to_collection, \"$\")) as belongs_to_collection,\n       SAFE_CAST(budget as Numeric)                         as budget,\n       PARSE_JSON(JSON_EXTRACT(genres, \"$\"))                as genres,\n       homepage,\n       SAFE_CAST(id as Numeric)                             as id,\n       imdb_id,\n       original_language,\n       original_title,\n       overview,\n       SAFE_CAST(popularity as NUMERIC)                     as popularity,\n       poster_path,\n       PARSE_JSON(JSON_EXTRACT(production_companies, \"$\"))  as production_companies,\n       PARSE_JSON(JSON_EXTRACT(production_countries, \"$\"))  as production_countries,\n       SAFE_CAST(release_date As DATE FORMAT 'YYYY-MM-DD')  as release_date,\n       SAFE_CAST(revenue as NUMERIC)                        as revenue,\n       SAFE_CAST(runtime as NUMERIC)                        as runtime,\n       PARSE_JSON(JSON_EXTRACT(spoken_languages, \"$\"))      as spoken_languages,\n       status,\n       tagline,\n       title,\n       SAFE_CAST(video as boolean)                          as video,\n       SAFE_CAST(vote_average as NUMERIC)                   as vote_average,\n       SAFE_CAST(vote_count as NUMERIC)                     as vote_count,\n       CURRENT_DATE()                                       as load_date\nFROM movie_source\n/*\n    Uncomment the line below to remove records with null `id` values\n*/", "relation_name": "`ee-india-se-data`.`movies_data_punit`.`movies_raw_to_curate`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-08T13:48:34.446857Z", "completed_at": "2024-08-08T13:48:34.450409Z"}, {"name": "execute", "started_at": "2024-08-08T13:48:34.450409Z", "completed_at": "2024-08-08T13:48:41.761389Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.316072702407837, "adapter_response": {"_message": "CREATE TABLE (13.0m rows, 370.5 MiB processed)", "code": "CREATE TABLE", "rows_affected": 13012144, "bytes_processed": 388465974, "bytes_billed": 389021696, "location": "US", "project_id": "ee-india-se-data", "job_id": "f28e9f8e-08a1-4c22-a534-8eda5499c79b", "slot_ms": 185669}, "message": "CREATE TABLE (13.0m rows, 370.5 MiB processed)", "failures": null, "unique_id": "model.movie_curate.rating_raw_to_curate", "compiled": true, "compiled_code": "\nWITH rating_source as (SELECT *,\n                        ROW_NUMBER() OVER(PARTITION BY userId, movieId ORDER BY timestamp desc) As row_num\n                       FROM ee-india-se-data.movies_data_punit.rating_raw)\nselect SAFE_CAST(userId as NUMERIC)  as userId,\n       SAFE_CAST(movieId as NUMERIC) as movieId,\n       SAFE_CAST(rating as NUMERIC)  as rating,\n       SAFE_CAST(timestamp as NUMERIC) as timestamp,\n       CURRENT_DATE() as load_date\nfrom rating_source\nWHERE row_num = 1", "relation_name": "`ee-india-se-data`.`movies_data_punit`.`rating_raw_to_curate`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-08T13:48:41.774339Z", "completed_at": "2024-08-08T13:48:41.780234Z"}, {"name": "execute", "started_at": "2024-08-08T13:48:41.781754Z", "completed_at": "2024-08-08T13:48:43.395393Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6252334117889404, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "ee-india-se-data", "job_id": "9352af69-5203-44c2-aefb-5a98dae0261b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.movie_curate.movie_rating_pres", "compiled": true, "compiled_code": "/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing \"table\" to \"view\" below\n*/\n\n\n\nWITH RATING_MEDIAN_DATA AS (\n    SELECT distinct movieId,\n                    PERCENTILE_CONT(rating, 0.5) OVER (PARTITION BY movieId) AS median,\n                    COUNT(rating) over (partition by movieId) As rating_count\n    FROM `ee-india-se-data`.`movies_data_punit`.`rating_raw_to_curate`\n)\n\nSELECT movieId              As Movie_Id,\n       movie.original_title As Title,\n       rating_count         As Number_Of_Rating,\n       median               as Median_Rating,\n       RANK() OVER (ORDER BY median desc) AS Movie_Rank\nFROM RATING_MEDIAN_DATA\n         JOIN `ee-india-se-data`.`movies_data_punit`.`movies_raw_to_curate` movie ON movie.id = RATING_MEDIAN_DATA.movieId\n\n\n/*\n    Uncomment the line below to remove records with null `id` values\n*/", "relation_name": "`ee-india-se-data`.`movies_data_punit`.`movie_rating_pres`"}], "elapsed_time": 18.783238410949707, "args": {"defer": false, "print": true, "profiles_dir": "C:\\Users\\user\\.dbt", "partial_parse": true, "warn_error_options": {"include": [], "exclude": []}, "send_anonymous_usage_stats": true, "which": "run", "log_level": "info", "favor_state": false, "use_colors": true, "write_json": true, "require_resource_names_without_spaces": false, "log_level_file": "debug", "log_format": "default", "select": [], "version_check": true, "partial_parse_file_diff": true, "enable_legacy_logger": false, "static_parser": true, "log_format_file": "debug", "empty": false, "vars": {}, "indirect_selection": "eager", "introspect": true, "source_freshness_run_project_hooks": false, "use_colors_file": true, "project_dir": "C:\\Users\\user\\Downloads\\DE\\de-journey\\dbt\\movie_curate", "cache_selected_only": false, "macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "printer_width": 80, "quiet": false, "populate_cache": true, "log_path": "C:\\Users\\user\\Downloads\\DE\\de-journey\\dbt\\movie_curate\\logs", "log_file_max_bytes": 10485760, "exclude": [], "invocation_command": "dbt run", "strict_mode": false}}